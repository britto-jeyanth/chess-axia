<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Chess</title>
    
    <!-- D3 -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
    
    <!-- Chess -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.2/chess.js"></script>
    
    <!-- Chessboard -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css" integrity="sha384-q94+BZtLrkL1/ohfjR8c6L+A6qzNH9R2hBLwyoAfu3i/WCvQjzL2RQJ3uNHDISdU" crossorigin="anonymous">  
    <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js" integrity="sha384-8Vi8VHwn3vjQ9eUHUxex3JSN/NFqUg3QbPyX8kWyb93+8AC/pPWTzj+nHtbC5bxD" crossorigin="anonymous"></script>
    
  </head>
  <body>
    <div id="myBoard" style="width: 400px"></div>
	<div id="boardConfig" style="width: 400px; height: 100px"></div>
    <script>
	
		//	Notation for chess piece and position
		//	Pieces: 1 character for color (w,b) and 
		//	1 character for piece type (pawn = "P", knight = "N", bishop = "B", rook = "R", queen = "Q" and king = "K")
		
		var positions = {}
		positions['e4'] = 'bK'
		positions['f4'] = 'wP'
		var boardConfig = {
			position:positions,
			draggable: true,
			dropOffBoard: 'trash',
			onSnapEnd: printPositions,
			onDrop: printPositions,
			sparePieces: true
		}
        
		var svgW = 400
		var svgH = 50
		var svgTextSize = 15
		var svg = d3.select('#boardConfig')
			.append('svg')
			.attr("width", svgW)
			.attr("height", svgH)		
			
		var text = svg.append('text')
			.attr('x',svgW/2)
			.attr('y', svgH/2)
			.attr('dominant-baseline', 'middle')
			.attr('text-anchor', 'middle')  
			.style('font-size', svgTextSize + 'px')
					
		var board = Chessboard('myBoard',boardConfig)
		
		function printPositions(){		
			text.text(JSON.stringify(board.position()).replace(/\"/g,'').replace(/\{/g,'').replace(/\}/g,'').replace(/\,/g,', '))
		}

    </script>
  </body>
</html>
